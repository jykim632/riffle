-- Riffle Seed Data
-- 개발 환경용 초기 데이터

-- ============================================================================
-- 1. 시즌 생성 (2026년 1분기: 3개월)
-- ============================================================================

INSERT INTO public.seasons (id, name, start_date, end_date, is_active)
VALUES (
  'V1StGXR8',  -- nanoid(8) 고정값
  '2026년 1분기',
  '2026-01-06',
  '2026-04-05',  -- 3개월 (약 13주)
  true
)
ON CONFLICT (id) DO NOTHING;

-- ============================================================================
-- 2. 주차 생성 (시즌 포함)
-- ============================================================================

INSERT INTO public.weeks (id, season_id, week_number, title, start_date, end_date, is_current)
VALUES
  ('abc12345', 'V1StGXR8', 1, '1주차', '2026-02-03', '2026-02-09', true),
  ('def67890', 'V1StGXR8', 2, '2주차', '2026-02-10', '2026-02-16', false)
ON CONFLICT (id) DO NOTHING;

-- ============================================================================
-- 3. 시즌 멤버 추가 (사용자가 이미 있는 경우)
-- ============================================================================

-- 참고: 실제 사용자가 있을 때만 실행
-- INSERT INTO public.season_members (season_id, user_id)
-- SELECT 'V1StGXR8', id FROM public.profiles
-- ON CONFLICT (season_id, user_id) DO NOTHING;

-- ============================================================================
-- 4. 테스트 사용자 프로필 (auth.users는 Supabase Auth에서 관리)
-- ============================================================================

-- 참고: 실제 사용자는 Supabase Auth의 signUp API로 생성해야 함
-- 아래는 직접 생성 시 예시 (로컬 개발용)

-- 테스트 관리자 프로필
-- INSERT INTO public.profiles (id, nickname, role)
-- VALUES (
--   '00000000-0000-0000-0000-000000000001'::uuid,
--   '관리자',
--   'admin'
-- )
-- ON CONFLICT (id) DO NOTHING;

-- 테스트 멤버 프로필
-- INSERT INTO public.profiles (id, nickname, role)
-- VALUES (
--   '00000000-0000-0000-0000-000000000002'::uuid,
--   '김철수',
--   'member'
-- ),
-- (
--   '00000000-0000-0000-0000-000000000003'::uuid,
--   '이영희',
--   'member'
-- )
-- ON CONFLICT (id) DO NOTHING;

-- ============================================================================
-- 3. 초대 코드 (테스트용)
-- ============================================================================

-- 참고: 실제 초대 코드는 애플리케이션에서 nanoid로 생성
-- 아래는 테스트용 고정 코드

-- INSERT INTO public.invite_codes (code, created_by, is_used)
-- VALUES (
--   'TEST1234',
--   '00000000-0000-0000-0000-000000000001'::uuid,  -- 관리자가 생성
--   false
-- )
-- ON CONFLICT (code) DO NOTHING;

-- ============================================================================
-- 5. 샘플 요약본 (테스트용)
-- ============================================================================

-- INSERT INTO public.summaries (week_id, author_id, content)
-- VALUES (
--   'abc12345',  -- 1주차 ID
--   '00000000-0000-0000-0000-000000000002'::uuid,  -- 김철수
--   '# 이번 주 경제 뉴스 요약
--
-- ## 주요 내용
-- - 금리 동결
-- - 환율 급등
--
-- ## 분석
-- 중앙은행의 금리 동결 결정은...'
-- )
-- ON CONFLICT DO NOTHING;

-- ============================================================================
-- 5. 개발 환경 확인
-- ============================================================================

-- 데이터 확인 쿼리
-- SELECT * FROM public.weeks;
-- SELECT * FROM public.profiles;
-- SELECT * FROM public.invite_codes;
-- SELECT * FROM public.summaries;
-- SELECT * FROM public.latest_summaries;
